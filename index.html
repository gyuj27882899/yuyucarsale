<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‚®ç‚®ç‹ | é¡¶çº§æœåŠ¡</title>
    
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥å›¾æ ‡åº“ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <!-- PapaParse (Google Sheet CSV è¯»å–ç”¨) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #1a1a1a; color: #fff; } /* æ”¹ä¸ºæ·±è‰²ä¸»é¢˜æ›´å…·è´¨æ„Ÿ */
        .profile-card { transition: transform 0.3s ease; background-color: #2d2d2d; }
        .profile-card:hover { transform: translateY(-5px); }
        .line-btn { background-color: #06C755; }
        .line-btn:hover { background-color: #05b34c; }
        
        /* æ¨¡æ€è§†çª— (Gallery Modal) æ ·å¼ */
        #gallery-modal { 
            backdrop-filter: blur(10px); 
            background-color: rgba(0, 0, 0, 0.95);
        }
        /* éšè—æ»šåŠ¨æ¡ä½†ä¿ç•™åŠŸèƒ½ */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* å›¾ç‰‡æ»‘åŠ¨ä¼˜åŒ– */
        .snap-x { scroll-snap-type: x mandatory; }
        .snap-center { scroll-snap-align: center; }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex flex-col">

    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <nav class="bg-gray-800 shadow-lg sticky top-0 z-40 border-b border-gray-700">
        <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa-solid fa-crown text-2xl text-yellow-500"></i>
                <span class="text-2xl font-black tracking-wider text-white">ç‚®ç‚®ç‹</span>
            </div>
            <a href="#" id="navLineBtn" target="_blank" class="line-btn text-white px-4 py-2 rounded-full text-sm font-bold flex items-center shadow-lg transform active:scale-95 transition">
                <i class="fa-brands fa-line text-xl mr-2"></i> å®¢æœ
            </a>
        </div>
    </nav>

    <!-- å¤´éƒ¨å¤§å›¾ -->
    <header class="relative overflow-hidden h-56 md:h-72">
        <!-- è¿™é‡Œçš„èƒŒæ™¯å›¾å¯ä»¥æ¢æˆæ›´æœ‰æ°›å›´çš„å¤œæ™¯æˆ–é…’å§å›¾ -->
        <div class="absolute inset-0 bg-[url('https://images.unsplash.com/photo-1566737236500-c8ac43014a67?q=80&w=1920&auto=format&fit=crop')] bg-cover bg-center opacity-40"></div>
        <div class="absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/60 to-transparent"></div>
        <div class="relative max-w-6xl mx-auto px-4 h-full flex flex-col justify-center items-center text-center">
            <h1 class="text-3xl md:text-5xl font-black mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-red-500">
                æè‡´ä½“éªŒï¼å°Šçˆµäº«å—
            </h1>
            <p class="text-gray-300 text-sm md:text-lg">æ»¡æ„åº¦ 100% | çœŸå®ç…§ç‰‡ | ä»·æ ¼é€æ˜</p>
        </div>
    </header>

    <!-- åˆ—è¡¨åŒº -->
    <section class="max-w-6xl mx-auto px-4 py-8 flex-grow">
        <!-- æœå¯» -->
        <div class="flex justify-center mb-8">
            <div class="relative w-full max-w-md">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-3.5 text-gray-400"></i>
                <input type="text" id="searchInput" placeholder="æœå¯»åå­—ã€å…³é”®å­—..." class="w-full pl-12 pr-4 py-3 bg-gray-800 border border-gray-700 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-yellow-500 transition shadow-inner placeholder-gray-500">
            </div>
        </div>

        <!-- è½½å…¥ä¸­æç¤º -->
        <div id="loading" class="text-center py-10">
            <i class="fa-solid fa-circle-notch fa-spin text-3xl text-yellow-500"></i>
            <p class="text-gray-500 mt-2">èµ„æ–™è¯»å–ä¸­...</p>
        </div>

        <!-- èµ„æ–™æ˜¾ç¤ºåŒº -->
        <div id="profiles-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 hidden">
            <!-- æ¡£æ¡ˆå°†ç”± JS ç”Ÿæˆ -->
        </div>

        <!-- æ— ç»“æœæç¤º -->
        <div id="no-results" class="hidden text-center py-20">
            <p class="text-gray-500 text-xl">ç›®å‰æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„èµ„æ–™</p>
        </div>
    </section>

    <!-- é¡µè„š -->
    <footer class="bg-black text-gray-600 py-6 mt-8 text-center border-t border-gray-800 text-xs">
        <p>&copy; 2025 ç‚®ç‚®ç‹. All Rights Reserved.</p>
    </footer>

    <!-- ç›¸å†Œå¼¹çª— (Modal) -->
    <div id="gallery-modal" class="fixed inset-0 z-50 hidden flex flex-col items-center justify-center">
        <!-- å…³é—­æŒ‰é’® -->
        <button onclick="closeGallery()" class="absolute top-4 right-4 text-white/80 hover:text-white text-4xl z-[60] focus:outline-none p-2">
            <i class="fa-solid fa-xmark"></i>
        </button>
        
        <!-- å¼¹çª—å†…å®¹å®¹å™¨ -->
        <div class="w-full max-w-5xl h-full flex flex-col justify-center relative">
            <h2 id="modal-title" class="text-xl md:text-2xl font-bold text-white mb-2 text-center pt-4 drop-shadow-md"></h2>
            
            <!-- å›¾ç‰‡æ»‘åŠ¨åŒº -->
            <div id="modal-images-container" class="flex overflow-x-auto space-x-4 p-4 hide-scrollbar snap-x h-[65vh] md:h-[75vh] items-center">
                <!-- å›¾ç‰‡ç”± JS æ’å…¥ -->
            </div>
            
            <div class="text-center pb-6 pt-2 px-4 w-full max-w-md mx-auto">
                <p class="text-gray-400 text-xs mb-3 animate-pulse"><i class="fa-solid fa-arrows-left-right mr-1"></i> å·¦å³æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š</p>
                <a href="#" id="modal-line-btn" target="_blank" class="line-btn text-white px-8 py-3 rounded-full text-lg font-bold shadow-lg transform active:scale-95 transition block w-full">
                    ç«‹å³ LINE é¢„å®š
                </a>
            </div>
        </div>
    </div>

    <!-- æ ¸å¿ƒé€»è¾‘ -->
    <script>
        // ==========================================
        // ğŸ‘‡ è®¾å®šåŒº (Google Sheet / LINE ID) ğŸ‘‡
        // ==========================================
        
        // 1. æ‚¨çš„ LINE ID (ä¸è¦åŠ  @)
        const myLineId = "ä½ çš„LINE_ID"; 
        
        // 2. Google Sheet CSV è¿ç»“
        // å¿…å¡«æ ä½: Name, Age, Body, Price, ExtraPrice, MainImage, GalleryImages
        const googleSheetCsvUrl = ""; 

        // ==========================================
        // ğŸ‘‡ èŒƒä¾‹èµ„æ–™ (å½“æ²¡æœ‰è¿ç»“ Google Sheet æ—¶æ˜¾ç¤º) ğŸ‘‡
        // ==========================================
        
        const defaultProfiles = [
            {
                id: 1,
                name: "å°ç¾",
                age: "20å²",
                body: "162 / 45 / C",
                price: "3500", 
                extraPrice: "500", 
                mainImage: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=800&auto=format&fit=crop",
                // ç›¸å†Œï¼šç”¨é€—å·åˆ†éš”å¤šä¸ªè¿ç»“
                galleryImages: "https://images.unsplash.com/photo-1544005313-94ddf0286df2?q=80&w=800, https://images.unsplash.com/photo-1517841905240-472988babdf9?q=80&w=800, https://images.unsplash.com/photo-1524504388940-b1c1722653e1?q=80&w=800",
                status: "available"
            },
            {
                id: 2,
                name: "Lisa",
                age: "24å²",
                body: "168 / 50 / D",
                price: "4000",
                extraPrice: "500",
                mainImage: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800&auto=format&fit=crop",
                galleryImages: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?q=80&w=800, https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?q=80&w=800",
                status: "available"
            },
            {
                id: 3,
                name: "å®‰å®‰",
                age: "22å²",
                body: "158 / 42 / B",
                price: "3200",
                extraPrice: "500",
                mainImage: "https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?q=80&w=800&auto=format&fit=crop",
                galleryImages: "https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?q=80&w=800",
                status: "busy" 
            }
        ];

        let profilesData = [];
        const container = document.getElementById('profiles-container');
        const searchInput = document.getElementById('searchInput');
        const modal = document.getElementById('gallery-modal');
        const loadingDiv = document.getElementById('loading');
        
        // æ›´æ–°é¡¶éƒ¨ LINE æŒ‰é’®
        document.getElementById('navLineBtn').href = `https://line.me/ti/p/~${myLineId}`;

        // åˆå§‹åŒ–
        function init() {
            if (googleSheetCsvUrl && googleSheetCsvUrl.startsWith('http')) {
                Papa.parse(googleSheetCsvUrl, {
                    download: true,
                    header: true,
                    complete: function(results) {
                        profilesData = results.data.filter(item => (item.Name || item.name) && (item.Name || item.name).trim() !== "");
                        loadingDiv.classList.add('hidden');
                        container.classList.remove('hidden');
                        renderProfiles(profilesData);
                    },
                    error: () => {
                        console.error("CSV è¯»å–å¤±è´¥ï¼Œä½¿ç”¨èŒƒä¾‹èµ„æ–™");
                        loadingDiv.classList.add('hidden');
                        container.classList.remove('hidden');
                        profilesData = defaultProfiles;
                        renderProfiles(profilesData);
                    }
                });
            } else {
                loadingDiv.classList.add('hidden');
                container.classList.remove('hidden');
                profilesData = defaultProfiles;
                renderProfiles(profilesData);
            }
        }

        // æ¸²æŸ“åˆ—è¡¨
        function renderProfiles(data) {
            container.innerHTML = '';
            
            if (data.length === 0) {
                document.getElementById('no-results').classList.remove('hidden');
                return;
            }
            document.getElementById('no-results').classList.add('hidden');

            data.forEach((profile, index) => {
                // èµ„æ–™æ ä½å¯¹åº” (å…¼å®¹å¤§å°å†™)
                const name = profile.Name || profile.name || "æœªå‘½å";
                const age = profile.Age || profile.age || "--";
                const body = profile.Body || profile.body || "--";
                const price = profile.Price || profile.price || "0";
                const extra = profile.ExtraPrice || profile.extraPrice || "500";
                const mainImg = profile.MainImage || profile.mainImage || "https://via.placeholder.com/600x800?text=No+Image";
                const status = (profile.Status || profile.status || "available").toLowerCase();
                
                // çŠ¶æ€å¾½ç« 
                let statusHtml = '';
                if (status === 'busy' || status === 'å¿™ç¢Œ') {
                    statusHtml = '<span class="absolute top-3 left-3 bg-red-600/90 text-white text-xs font-bold px-3 py-1 rounded shadow-md z-10 backdrop-blur-sm">å¿™ç¢Œä¸­</span>';
                } else {
                    statusHtml = '<span class="absolute top-3 left-3 bg-green-500/90 text-white text-xs font-bold px-3 py-1 rounded shadow-md z-10 backdrop-blur-sm">å¯é¢„çº¦</span>';
                }

                // LINE é¢„å®šè¿ç»“
                const lineMsg = encodeURIComponent(`ä½ å¥½ï¼Œæˆ‘æƒ³é¢„å®šã€Œ${name}ã€ï¼Œæ–¹æ¡ˆ $${price}/40åˆ†é’Ÿ`);
                const lineUrl = `https://line.me/ti/p/~${myLineId}?text=${lineMsg}`;

                const cardHtml = `
                    <div class="profile-card rounded-xl overflow-hidden shadow-lg relative group border border-gray-700">
                        ${statusHtml}
                        
                        <!-- ä¸»å›¾ (ç‚¹å‡»è§¦å‘ç›¸å†Œ) -->
                        <div class="h-96 overflow-hidden relative cursor-pointer" onclick="openGallery(${index})">
                            <img src="${mainImg}" alt="${name}" loading="lazy" class="w-full h-full object-cover transition duration-500 group-hover:scale-110 opacity-90 group-hover:opacity-100">
                            
                            <!-- æ”¾å¤§é•œæç¤º -->
                            <div class="absolute inset-0 bg-black/30 group-hover:bg-black/10 transition flex items-center justify-center">
                                <i class="fa-solid fa-expand text-white/80 opacity-0 group-hover:opacity-100 text-5xl drop-shadow-lg transform scale-50 group-hover:scale-100 transition duration-300"></i>
                            </div>
                            
                            <!-- åº•éƒ¨åå­—å±‚ -->
                            <div class="absolute bottom-0 w-full bg-gradient-to-t from-black via-black/70 to-transparent p-4 pt-12">
                                <h3 class="text-3xl font-black text-white drop-shadow-md tracking-wide">${name}</h3>
                            </div>
                        </div>

                        <!-- èµ„è®¯æ  -->
                        <div class="p-5 bg-[#2d2d2d]">
                            <!-- è¯¦ç»†èµ„è®¯ -->
                            <div class="grid grid-cols-2 gap-3 mb-5 text-sm">
                                <div class="bg-gray-800/50 p-2 rounded flex items-center justify-center border border-gray-700">
                                    <i class="fa-solid fa-cake-candles text-yellow-500 mr-2"></i> 
                                    <span class="text-gray-200">è½¦é¾„: ${age}</span>
                                </div>
                                <div class="bg-gray-800/50 p-2 rounded flex items-center justify-center border border-gray-700">
                                    <i class="fa-solid fa-ruler-vertical text-yellow-500 mr-2"></i> 
                                    <span class="text-gray-200">è½¦èº«: ${body}</span>
                                </div>
                            </div>
                            
                            <!-- ä»·æ ¼æ–¹æ¡ˆ -->
                            <div class="bg-gray-900 rounded-lg p-3 mb-5 border border-gray-700 shadow-inner">
                                <div class="flex justify-between items-center mb-1">
                                    <span class="text-gray-400 text-sm">åŸºæœ¬æ–¹æ¡ˆ</span>
                                    <span class="text-xl font-bold text-yellow-400">$${price} <span class="text-xs text-gray-500 font-normal">/ 40åˆ†é’Ÿ</span></span>
                                </div>
                                <div class="flex justify-between items-center text-xs border-t border-gray-800 pt-1 mt-1">
                                    <span class="text-gray-500">åŠ èŠ‚è´¹ç”¨</span>
                                    <span class="text-gray-400">+$${extra}</span>
                                </div>
                            </div>

                            <!-- æŒ‰é’® -->
                            <a href="${lineUrl}" target="_blank" onclick="event.stopPropagation()" class="line-btn w-full text-white font-black text-lg py-3 rounded-lg flex justify-center items-center shadow-lg hover:shadow-green-500/50 transition">
                                <i class="fa-brands fa-line mr-2"></i> ç«‹å³ LINE é¢„å®š
                            </a>
                        </div>
                    </div>
                `;
                container.innerHTML += cardHtml;
            });
        }

        // æ‰“å¼€ç›¸å†Œ (Modal)
        function openGallery(index) {
            // æ¯æ¬¡æ‰“å¼€æ—¶ï¼Œä»ç›®å‰çš„èµ„æ–™é˜µåˆ— (filtered æˆ– full) ä¸­æŠ“å–
            // è¿™é‡Œä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬é‡æ–°åœ¨å…¨åŸŸèµ„æ–™ä¸­æœå¯»æˆ–ç›´æ¥ä½¿ç”¨ profilesData (è‹¥æ— ç­›é€‰)
            // å»ºè®®ï¼šç›´æ¥ç”¨å½“ä¸‹çš„ profilesData[index] å¯èƒ½ä¼šæœ‰æ’åºé—®é¢˜ï¼Œ
            // ä½†å¦‚æœ filterAndSort é€»è¾‘æ²¡æ”¹åŠ¨åŸé˜µåˆ—é¡ºåºåˆ™æ²¡é—®é¢˜ã€‚
            // è¿™é‡Œæˆ‘ä»¬ç”¨ profilesDataï¼ˆå®ƒä¼šè¢«æœå¯»åŠŸèƒ½æ›´æ–°å—ï¼Ÿæœå¯»ç›®å‰æ˜¯è¿‡æ»¤åæ¸²æŸ“ï¼Œæ‰€ä»¥ index ä¼šå˜ï¼‰
            
            // ä¿®æ­£ï¼šæœå¯»å index ä¼šå¯¹ä¸ä¸Šã€‚æˆ‘ä»¬éœ€è¦åœ¨ render æ—¶æŠŠåŸå§‹ç‰©ä»¶ä¼ è¿›å»ï¼Œæˆ–è€…ç®€å•ç‚¹ï¼Œ
            // æˆ‘ä»¬å‡è®¾æœå¯»ä¸å¸¸ç”¨ï¼Œæˆ–è€…ç›´æ¥åœ¨ render é‡Œå­˜å½“å‰æ˜¾ç¤ºçš„èµ„æ–™ã€‚
            
            // ç®€å•è§£æ³•ï¼šrenderCars æ—¶æˆ‘ä»¬æŠŠæ•´ä¸ªç‰©ä»¶èµ„æ–™ç»‘åœ¨ DOM ä¸Šï¼Œæˆ–è€…ä½¿ç”¨å…¨åŸŸå˜æ•° currentDisplayedData
            // ç”±äºä¸Šé¢ renderProfiles æ²¡æœ‰å‚¨å­˜ currentDisplayedDataï¼Œæˆ‘ä»¬æ”¹ä¸€ä¸‹é€»è¾‘ï¼š
            
            // ä¸ºäº†é¿å… bugï¼Œæˆ‘ä»¬ç›´æ¥ä» DOM è·å–æˆ–è€…åœ¨ render æ—¶æŠŠèµ„æ–™å­˜å…¥å…¨åŸŸ
            const profile = currentDisplayedData[index]; // ä½¿ç”¨å½“å‰æ˜¾ç¤ºçš„èµ„æ–™
            if(!profile) return;

            const modalTitle = document.getElementById('modal-title');
            const modalContainer = document.getElementById('modal-images-container');
            const modalLineBtn = document.getElementById('modal-line-btn');
            
            modalTitle.innerText = (profile.Name || profile.name);
            
            // ç»„åˆæ‰€æœ‰å›¾ç‰‡ï¼šä¸»å›¾ + ç›¸å†Œå›¾
            let images = [];
            const mainImg = profile.MainImage || profile.mainImage;
            if(mainImg) images.push(mainImg);
            
            let galleryRaw = profile.GalleryImages || profile.galleryImages || "";
            if(galleryRaw) {
                // åˆ†å‰²é€—å·ï¼Œå»å¤´å»å°¾ç©ºæ ¼
                const galleryUrls = galleryRaw.split(/[,ï¼Œ\s]+/).filter(url => url.length > 5);
                images = images.concat(galleryUrls);
            }

            // ç”Ÿæˆå›¾ç‰‡ HTML (ä¿®æ­£æ ·å¼ä»¥é€‚åº”ä¸åŒæ¯”ä¾‹)
            if(images.length === 0) {
                modalContainer.innerHTML = `<p class="text-white">æš‚æ— æ›´å¤šç…§ç‰‡</p>`;
            } else {
                modalContainer.innerHTML = images.map(url => `
                    <div class="snap-center shrink-0 w-full h-full flex items-center justify-center p-2">
                        <img src="${url}" class="max-h-full max-w-full object-contain rounded-lg shadow-2xl bg-black/50">
                    </div>
                `).join('');
            }

            // è®¾å®š Modal é‡Œçš„ Line æŒ‰é’®
            const price = profile.Price || profile.price || "";
            const lineMsg = encodeURIComponent(`ä½ å¥½ï¼Œæˆ‘æ­£åœ¨çœ‹ã€Œ${profile.Name||profile.name}ã€çš„ç…§ç‰‡ï¼Œæƒ³é¢„å®šæ–¹æ¡ˆ $${price}/40åˆ†é’Ÿ`);
            modalLineBtn.href = `https://line.me/ti/p/~${myLineId}?text=${lineMsg}`;

            // æ˜¾ç¤º Modal
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // ç¦æ­¢èƒŒæ™¯å·åŠ¨
        }

        // å…³é—­ç›¸å†Œ
        function closeGallery() {
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // æ¢å¤å·åŠ¨
        }
        
        // ç‚¹å‡» Modal èƒŒæ™¯ä¹Ÿå¯ä»¥å…³é—­
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeGallery();
        });

        // æœå¯»åŠŸèƒ½
        let currentDisplayedData = []; // ç”¨æ¥å­˜å½“å‰æ˜¾ç¤ºçš„èµ„æ–™ï¼Œç»™ modal ç”¨
        
        function performSearch() {
            const term = searchInput.value.toLowerCase();
            const filtered = profilesData.filter(p => {
                const n = (p.Name || p.name).toLowerCase();
                // å¦‚æœæœ‰ Tag ä¹Ÿå¯ä»¥æœ
                const t = (p.Tags || p.tags || "").toString().toLowerCase();
                return n.includes(term) || t.includes(term);
            });
            currentDisplayedData = filtered;
            renderProfiles(filtered);
        }

        searchInput.addEventListener('input', performSearch);

        // åˆå§‹åŒ–
        init();
        // é¢„è®¾æ˜¾ç¤ºçš„èµ„æ–™ç­‰äºå…¨éƒ¨èµ„æ–™
        currentDisplayedData = defaultProfiles; 
    </script>
</body>
</html>
